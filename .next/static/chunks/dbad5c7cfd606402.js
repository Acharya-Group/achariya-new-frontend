(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e.s(["_",()=>t])},10160,e=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.s(["default",()=>t])},3082,e=>{"use strict";e.s(["default",()=>n]);var t=e.i(63816),a=e.i(66027),s=e.i(54616),l=e.i(12598);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,r=(0,l.useQueryClient)(),i=(0,a.useQuery)({queryKey:["stationeryOrders",e,n],queryFn:async()=>{let{data:a}=await t.default.get("/Order",{params:{page:e,limit:n}});return a},initialData:{success:!0,message:"Initial",data:[],page:1,total:0,totalPages:0}}),d=(0,s.useMutation)({mutationFn:async e=>{let{data:a}=await t.default.post("/Order",e);return a.data},onSuccess:e=>{r.setQueryData(["stationeryOrders"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...t,e]})}}),o=(0,s.useMutation)({mutationFn:async e=>{let{data:a}=await t.default.put("/Order/".concat(e._id),e);return a.data},onSuccess:e=>{r.setQueryData(["stationeryOrders"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(t=>t._id===e._id?e:t)})}});return{allOrders:i,createOrder:d,updateOrder:o,deleteOrder:(0,s.useMutation)({mutationFn:async e=>(await t.default.delete("/Order/".concat(e)),e),onSuccess:e=>{r.setQueryData(["stationeryOrders"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter(t=>t._id!==e)})}}),initiatePayment:(0,s.useMutation)({mutationFn:async e=>{var a;let{data:s}=await t.default.post("/Payment/initiate",e);if(!(null==(a=s.data)?void 0:a.action))throw Error("Payment data not returned by backend");return s}})}}},89277,e=>{"use strict";e.s(["default",()=>c]);var t=e.i(43476),a=e.i(71645),s=e.i(38298),l=e.i(30955),n=e.i(5766),r=e.i(3082),i=e.i(80790),d=e.i(55749),o=e.i(45700);let c=()=>{let[e,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(1),[p,h]=(0,a.useState)("all"),[x,y]=(0,a.useState)(""),[f,j]=(0,a.useState)("all"),[v,g]=(0,a.useState)(""),[b,N]=(0,a.useState)(""),[S,D]=(0,a.useState)([]),[k,w]=(0,a.useState)(!1),{allOrders:P,deleteOrder:C}=(0,r.default)(u,200);if((0,a.useEffect)(()=>c(!0),[]),!e)return null;if(P.isLoading)return(0,t.jsx)(s.default,{children:(0,t.jsx)("p",{children:"Loading orders..."})});let A=P.data,O=(null==A?void 0:A.data)||[],I=(null==A?void 0:A.totalPages)||1,T=O.filter(e=>{var t;let a="all"===p||e.paymentStatus===p,s=""===x.trim()||(null!=(t=e.kioskId)?t:"").toLowerCase().includes(x.toLowerCase()),l=e.createdAt?new Date(e.createdAt):null,n=new Date,r=!0;if(l){if("today"===f)r=l.toDateString()===n.toDateString();else if("last3"===f){let e=new Date;e.setDate(n.getDate()-3),r=l>=e&&l<=n}else if("last7"===f){let e=new Date;e.setDate(n.getDate()-7),r=l>=e&&l<=n}else if("custom"===f&&v&&b){let e=new Date(v),t=new Date(b);r=l>=e&&l<=t}}return a&&s&&r}),_=Array.from(new Set(T.flatMap(e=>{var t;return(null==(t=e.items)?void 0:t.map(e=>e.type))||[]}))),F=["Date","Name","Phone","Amount","Payment","TransactionID","Kiosk","Address","Pin","Status",..._],E=T.map(e=>{var t,a,s,l,n,r,i,d,o,c,u,m;let p={Date:null!=(s=null==(t=e.createdAt)?void 0:t.split("T")[0])?s:"",Name:null!=(l=e.name)?l:"",Phone:null!=(n=e.phoneNo)?n:"",Amount:null!=(r=e.amount)?r:"",Payment:null!=(i=e.paymentStatus)?i:"",TransactionID:null!=(d=e.transactionId)?d:"",Kiosk:null!=(o=e.kioskId)?o:"",Address:null!=(c=e.address)?c:"",Pin:null!=(u=e.pinCode)?u:"",Status:null!=(m=e.status)?m:""};return _.forEach(e=>p[e]=0),null==(a=e.items)||a.forEach(e=>{p[e.type]=e.quantity}),p});return(0,t.jsx)(s.default,{children:(0,t.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-md",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Orders"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,t.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(T,null,2)),n.default.success("Copied to clipboard!")},className:"px-4 py-2 bg-gray-200 rounded",children:"Copy"}),(0,t.jsx)(i.CSVLink,{data:E,headers:F.map(e=>({label:e,key:e})),filename:"orders.csv",className:"px-4 py-2 bg-gray-200 rounded",children:"CSV"}),(0,t.jsx)("button",{onClick:()=>{let e=new d.default;e.text("Stationery Orders",14,16);let t=T.map(e=>{var t,a,s,l,n,r,i,d,o,c,u;return[e.createdAt?e.createdAt.split("T")[0]:"",null!=(a=e.name)?a:"",null!=(s=e.phoneNo)?s:"",null!=(l=e.amount)?l:"",null!=(n=e.paymentStatus)?n:"",null!=(r=e.transactionId)?r:"",null!=(i=e.kioskId)?i:"",null!=(d=e.address)?d:"",null!=(o=e.pinCode)?o:"",null!=(c=e.status)?c:"",null!=(u=null==(t=e.items)?void 0:t.map(e=>"".concat(e.type," (").concat(e.quantity,")")).join(", "))?u:""]});(0,o.default)(e,{head:[["Date","Name","Phone","Amount","Payment","Txn ID","Kiosk","Address","Pin","Status","Items"]],body:t,startY:20}),e.save("orders-list.pdf")},className:"px-4 py-2 bg-gray-200 rounded",children:"PDF"}),(0,t.jsx)("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-gray-200 rounded",children:"Print"}),(0,t.jsx)("button",{onClick:()=>{if(!S.length)return n.default.error("No orders selected");confirm("Delete ".concat(S.length," selected orders?"))&&(S.forEach(e=>C.mutate(e,{onSuccess:()=>n.default.success("Order deleted!"),onError:()=>n.default.error("Delete failed")})),D([]),w(!1))},className:"px-4 py-2 bg-red-500 text-white rounded",children:"Delete Selected"})]}),(0,t.jsx)("div",{className:"overflow-x-auto mb-4",children:(0,t.jsxs)("div",{className:"flex gap-4 min-w-max",children:[(0,t.jsxs)("select",{value:p,onChange:e=>{h(e.target.value),m(1)},className:"p-2 border rounded",children:[(0,t.jsx)("option",{value:"all",children:"All Payments"}),(0,t.jsx)("option",{value:"success",children:"Success"}),(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"failed",children:"Failed"})]}),(0,t.jsx)("input",{type:"text",placeholder:"Filter by kiosk ID...",value:x,onChange:e=>{y(e.target.value),m(1)},className:"p-2 border rounded"}),(0,t.jsxs)("select",{value:f,onChange:e=>{j(e.target.value),m(1)},className:"p-2 border rounded",children:[(0,t.jsx)("option",{value:"all",children:"All Dates"}),(0,t.jsx)("option",{value:"today",children:"Today"}),(0,t.jsx)("option",{value:"last3",children:"Last 3 Days"}),(0,t.jsx)("option",{value:"last7",children:"Last 7 Days"}),(0,t.jsx)("option",{value:"custom",children:"Custom Range"})]}),"custom"===f&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"date",value:v,onChange:e=>g(e.target.value),className:"p-2 border rounded"}),(0,t.jsx)("input",{type:"date",value:b,onChange:e=>N(e.target.value),className:"p-2 border rounded"})]})]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-375 w-full border",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-2",children:(0,t.jsx)("input",{type:"checkbox",checked:k,onChange:()=>{k?(D([]),w(!1)):(D(T.map(e=>e._id)),w(!0))}})}),(0,t.jsx)("th",{className:"p-2",children:"#"}),(0,t.jsx)("th",{className:"p-2",children:"Date"}),(0,t.jsx)("th",{className:"p-2",children:"Name"}),(0,t.jsx)("th",{className:"p-2",children:"Phone"}),(0,t.jsx)("th",{className:"p-2",children:"Amount"}),(0,t.jsx)("th",{className:"p-2",children:"Payment"}),(0,t.jsx)("th",{className:"p-2",children:"Kiosk"}),(0,t.jsx)("th",{className:"p-2",children:"Items"}),(0,t.jsx)("th",{className:"p-2",children:"Action"})]})}),(0,t.jsx)("tbody",{children:T.map((e,a)=>{var s,r;return(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)("input",{type:"checkbox",checked:S.includes(e._id),onChange:()=>(e=>{D(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e._id)})}),(0,t.jsx)("td",{className:"p-2",children:a+1}),(0,t.jsx)("td",{className:"p-2",children:null==(s=e.createdAt)?void 0:s.split("T")[0]}),(0,t.jsx)("td",{className:"p-2",children:e.name}),(0,t.jsx)("td",{className:"p-2",children:e.phoneNo}),(0,t.jsxs)("td",{className:"p-2",children:["â‚¹",e.amount]}),(0,t.jsx)("td",{className:"p-2",children:e.paymentStatus}),(0,t.jsx)("td",{className:"p-2",children:e.kioskId}),(0,t.jsx)("td",{className:"p-2",children:null==(r=e.items)?void 0:r.map((e,a)=>(0,t.jsxs)("div",{children:[e.type," - ",e.quantity]},a))}),(0,t.jsx)("td",{className:"p-2",children:(0,t.jsx)("button",{onClick:()=>{var t;return t=e._id,void(confirm("Delete this order?")&&C.mutate(t,{onSuccess:()=>n.default.success("Order deleted!"),onError:()=>n.default.error("Delete failed")}))},className:"bg-red-500 text-white p-2 rounded",children:(0,t.jsx)(l.FaTrash,{})})})]},e._id)})})]})}),(0,t.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-4",children:[(0,t.jsx)("button",{disabled:(null==A?void 0:A.page)===1,onClick:()=>m(e=>e-1),className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Prev"}),(0,t.jsxs)("span",{children:["Page ",(null==A?void 0:A.page)||1," of ",I]}),(0,t.jsx)("button",{disabled:(null==A?void 0:A.page)===I,onClick:()=>m(e=>e+1),className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Next"})]})]})})}},48503,e=>{e.v(t=>Promise.all(["static/chunks/973cd2e0d44fcf4d.js"].map(t=>e.l(t))).then(()=>t(15833)))},70653,e=>{e.v(t=>Promise.all(["static/chunks/c1eb2087dd9024e6.js"].map(t=>e.l(t))).then(()=>t(24154)))},95111,e=>{e.v(t=>Promise.all(["static/chunks/5f9918d1ea162d49.js"].map(t=>e.l(t))).then(()=>t(38201)))}]);