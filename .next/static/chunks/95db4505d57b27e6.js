(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,99749,e=>{"use strict";function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e.s(["_",()=>t])},10160,e=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.s(["default",()=>t])},3082,e=>{"use strict";e.s(["default",()=>n]);var t=e.i(63816),a=e.i(66027),l=e.i(54616),s=e.i(12598);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,r=(0,s.useQueryClient)(),d=(0,a.useQuery)({queryKey:["stationeryOrders",e,n],queryFn:async()=>{let{data:a}=await t.default.get("/Order",{params:{page:e,limit:n}});return a},initialData:{success:!0,message:"Initial",data:[],page:1,total:0,totalPages:0}}),i=(0,l.useMutation)({mutationFn:async e=>{let{data:a}=await t.default.post("/Order",e);return a.data},onSuccess:e=>{r.setQueryData(["stationeryOrders"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...t,e]})}}),o=(0,l.useMutation)({mutationFn:async e=>{let{data:a}=await t.default.put("/Order/".concat(e._id),e);return a.data},onSuccess:e=>{r.setQueryData(["stationeryOrders"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(t=>t._id===e._id?e:t)})}});return{allOrders:d,createOrder:i,updateOrder:o,deleteOrder:(0,l.useMutation)({mutationFn:async e=>(await t.default.delete("/Order/".concat(e)),e),onSuccess:e=>{r.setQueryData(["stationeryOrders"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter(t=>t._id!==e)})}}),initiatePayment:(0,l.useMutation)({mutationFn:async e=>{var a;let{data:l}=await t.default.post("/Payment/initiate",e);if(!(null==(a=l.data)?void 0:a.action))throw Error("Payment data not returned by backend");return l}})}}},89277,e=>{"use strict";e.s(["default",()=>c]);var t=e.i(43476),a=e.i(71645),l=e.i(38298),s=e.i(30955),n=e.i(5766),r=e.i(3082),d=e.i(80790),i=e.i(55749),o=e.i(45700);let c=()=>{let[e,c]=(0,a.useState)(!1),[u,p]=(0,a.useState)(1),[x,m]=(0,a.useState)("all"),[h,y]=(0,a.useState)(""),[f,j]=(0,a.useState)("all"),[v,g]=(0,a.useState)(""),[N,b]=(0,a.useState)(""),[S,D]=(0,a.useState)([]),[w,k]=(0,a.useState)(!1),{allOrders:P,deleteOrder:C}=(0,r.default)(u,200);if((0,a.useEffect)(()=>c(!0),[]),!e)return null;if(P.isLoading)return(0,t.jsx)(l.default,{children:(0,t.jsx)("p",{children:"Loading orders..."})});let A=P.data,I=(null==A?void 0:A.data)||[],O=(null==A?void 0:A.totalPages)||1,T=I.filter(e=>{var t;let a="all"===x||e.paymentStatus===x,l=""===h.trim()||(null!=(t=e.kioskId)?t:"").toLowerCase().includes(h.toLowerCase()),s=e.createdAt?new Date(e.createdAt):null,n=new Date,r=!0;if(s){if("today"===f)r=s.toDateString()===n.toDateString();else if("last3"===f){let e=new Date;e.setDate(n.getDate()-3),r=s>=e&&s<=n}else if("last7"===f){let e=new Date;e.setDate(n.getDate()-7),r=s>=e&&s<=n}else if("custom"===f&&v&&N){let e=new Date(v),t=new Date(N);r=s>=e&&s<=t}}return a&&l&&r}),_=Math.max(...T.map(e=>{var t;return(null==(t=e.items)?void 0:t.length)||0})),F=["Date","Name","Phone","Amount","Payment","TransactionID","Kiosk","Address","Pin","Status",...Array.from({length:_},(e,t)=>"Item ".concat(t+1))],K=T.map(e=>{var t,a,l,s,n,r,d,i,o,c,u;let p={Date:e.createdAt?e.createdAt.split("T")[0]:"",Name:null!=(a=e.name)?a:"",Phone:null!=(l=e.phoneNo)?l:"",Amount:null!=(s=null==(t=e.amount)?void 0:t.toString())?s:"",Payment:null!=(n=e.paymentStatus)?n:"",TransactionID:null!=(r=e.transactionId)?r:"",Kiosk:null!=(d=e.kioskId)?d:"",Address:null!=(i=e.address)?i:"",Pin:null!=(o=e.pinCode)?o:"",Status:null!=(c=e.status)?c:""};for(let t=0;t<_;t++)p["Item ".concat(t+1)]=(null==(u=e.items)?void 0:u[t])?"".concat(e.items[t].type," (").concat(e.items[t].quantity,")"):"";return p});return(0,t.jsx)(l.default,{children:(0,t.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-md",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Orders"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4",children:[(0,t.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(JSON.stringify(T,null,2)),n.default.success("Copied to clipboard!")},className:"px-4 py-2 bg-gray-200 rounded",children:"Copy"}),(0,t.jsx)(d.CSVLink,{data:K,headers:F.map(e=>({label:e,key:e})),filename:"orders.csv",className:"px-4 py-2 bg-gray-200 rounded",children:"CSV"}),(0,t.jsx)("button",{onClick:()=>{let e=new i.default;e.text("Stationery Orders",14,16);let t=T.map(e=>{var t,a,l,s,n,r,d,i,o,c,u;return[e.createdAt?e.createdAt.split("T")[0]:"",null!=(a=e.name)?a:"",null!=(l=e.phoneNo)?l:"",null!=(s=e.amount)?s:"",null!=(n=e.paymentStatus)?n:"",null!=(r=e.transactionId)?r:"",null!=(d=e.kioskId)?d:"",null!=(i=e.address)?i:"",null!=(o=e.pinCode)?o:"",null!=(c=e.status)?c:"",null!=(u=null==(t=e.items)?void 0:t.map(e=>"".concat(e.type," (").concat(e.quantity,")")).join(", "))?u:""]});(0,o.default)(e,{head:[["Date","Name","Phone","Amount","Payment","Txn ID","Kiosk","Address","Pin","Status","Items"]],body:t,startY:20}),e.save("orders-list.pdf")},className:"px-4 py-2 bg-gray-200 rounded",children:"PDF"}),(0,t.jsx)("button",{onClick:()=>window.print(),className:"px-4 py-2 bg-gray-200 rounded",children:"Print"}),(0,t.jsx)("button",{onClick:()=>{if(!S.length)return n.default.error("No orders selected");confirm("Delete ".concat(S.length," selected orders?"))&&(S.forEach(e=>C.mutate(e,{onSuccess:()=>n.default.success("Order deleted!"),onError:()=>n.default.error("Delete failed")})),D([]),k(!1))},className:"px-4 py-2 bg-red-500 text-white rounded",children:"Delete Selected"})]}),(0,t.jsx)("div",{className:"overflow-x-auto mb-4",children:(0,t.jsxs)("div",{className:"flex gap-4 min-w-max",children:[(0,t.jsxs)("select",{value:x,onChange:e=>{m(e.target.value),p(1)},className:"p-2 border rounded",children:[(0,t.jsx)("option",{value:"all",children:"All Payments"}),(0,t.jsx)("option",{value:"success",children:"Success"}),(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"failed",children:"Failed"})]}),(0,t.jsx)("input",{type:"text",placeholder:"Filter by kiosk ID...",value:h,onChange:e=>{y(e.target.value),p(1)},className:"p-2 border rounded"}),(0,t.jsxs)("select",{value:f,onChange:e=>{j(e.target.value),p(1)},className:"p-2 border rounded",children:[(0,t.jsx)("option",{value:"all",children:"All Dates"}),(0,t.jsx)("option",{value:"today",children:"Today"}),(0,t.jsx)("option",{value:"last3",children:"Last 3 Days"}),(0,t.jsx)("option",{value:"last7",children:"Last 7 Days"}),(0,t.jsx)("option",{value:"custom",children:"Custom Range"})]}),"custom"===f&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"date",value:v,onChange:e=>g(e.target.value),className:"p-2 border rounded"}),(0,t.jsx)("input",{type:"date",value:N,onChange:e=>b(e.target.value),className:"p-2 border rounded"})]})]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-[1500px] divide-y divide-gray-200 w-full",children:[(0,t.jsx)("thead",{className:"bg-secondary text-white",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2",children:(0,t.jsx)("input",{type:"checkbox",checked:w,onChange:()=>{w?(D([]),k(!1)):(D(T.map(e=>e._id)),k(!0))}})}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"#"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Date"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Name"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Phone"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Amount"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Payment"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Txn ID"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Kiosk ID"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Address"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Pin"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Items"}),(0,t.jsx)("th",{className:"px-4 py-2 text-left",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map((e,a)=>{var l,r,d,i,o,c,p,x,m,h,y,f;return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("input",{type:"checkbox",checked:S.includes(e._id),onChange:()=>(e=>{D(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e._id)})}),(0,t.jsx)("td",{className:"px-4 py-2",children:(u-1)*200+a+1}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(d=null==(l=e.createdAt)?void 0:l.split("T")[0])?d:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(i=e.name)?i:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(o=e.phoneNo)?o:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(c=e.amount)?c:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(p=e.paymentStatus)?p:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(x=e.transactionId)?x:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(m=e.kioskId)?m:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("div",{className:"max-h-[100px] p-2 border rounded overflow-y-auto",children:null!=(h=e.address)?h:""})}),(0,t.jsx)("td",{className:"px-4 py-2",children:null!=(y=e.pinCode)?y:""}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("ul",{className:"list-disc pl-4",children:null!=(f=null==(r=e.items)?void 0:r.map((e,a)=>(0,t.jsxs)("li",{children:[e.type," - ",e.quantity]},a)))?f:""})}),(0,t.jsx)("td",{className:"px-4 py-2",children:(0,t.jsx)("button",{onClick:()=>{var t;return t=e._id,void(confirm("Delete this order?")&&C.mutate(t,{onSuccess:()=>n.default.success("Order deleted!"),onError:()=>n.default.error("Delete failed")}))},className:"p-2 bg-red-500 text-white rounded",children:(0,t.jsx)(s.FaTrash,{})})})]},e._id)})})]})}),(0,t.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-4",children:[(0,t.jsx)("button",{disabled:(null==A?void 0:A.page)===1,onClick:()=>p(e=>e-1),className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Prev"}),(0,t.jsxs)("span",{children:["Page ",(null==A?void 0:A.page)||1," of ",O]}),(0,t.jsx)("button",{disabled:(null==A?void 0:A.page)===O,onClick:()=>p(e=>e+1),className:"px-3 py-1 bg-gray-200 rounded disabled:opacity-50",children:"Next"})]})]})})}},48503,e=>{e.v(t=>Promise.all(["static/chunks/973cd2e0d44fcf4d.js"].map(t=>e.l(t))).then(()=>t(15833)))},70653,e=>{e.v(t=>Promise.all(["static/chunks/c1eb2087dd9024e6.js"].map(t=>e.l(t))).then(()=>t(24154)))},95111,e=>{e.v(t=>Promise.all(["static/chunks/5f9918d1ea162d49.js"].map(t=>e.l(t))).then(()=>t(38201)))}]);