{"version":3,"sources":["turbopack:///[project]/src/hooks/admin.ts","turbopack:///[project]/node_modules/axios/index.js","turbopack:///[project]/src/app/admin/change-password/page.tsx"],"sourcesContent":["import { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport api from \"@/lib/axios\";\n\nexport interface Admin {\n  _id: string;\n  username: string;\n  email: string;\n}\n\nexport interface LoginResponse {\n  message: string;\n  admin: Admin;\n  token: string;\n}\n\nexport interface LoginCredentials {\n  email: string;\n  password: string;\n}\n\nexport interface VerifyPasswordPayload {\n  password: string;\n}\n\nexport interface VerifyPasswordResponse {\n  success: boolean;\n  message: string;\n}\n\nexport interface UpdatePasswordPayload {\n  currentPassword: string;\n  newPassword: string;\n}\n\nexport interface UpdatePasswordResponse {\n  message: string;\n}\n\n// ✅ Login hook stays unchanged\nexport const useAdminLogin = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation<LoginResponse, unknown, LoginCredentials>({\n    mutationFn: async (credentials) => {\n      const { data } = await api.post(\"/admin/login\", credentials);\n      return data;\n    },\n    onSuccess: (data) => {\n      localStorage.setItem(\"adminToken\", data.token);\n      queryClient.setQueryData([\"admin\"], data.admin);\n    },\n  });\n};\n\n// ✅ Update password hook\nexport const useUpdatePassword = () => {\n  return useMutation<UpdatePasswordResponse, unknown, UpdatePasswordPayload>({\n    mutationFn: async (payload: UpdatePasswordPayload) => {\n      const token = localStorage.getItem(\"adminToken\");\n      const { data } = await api.put(\"/admin/update-password\", payload, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      return data;\n    },\n  });\n};\n\n// ✅ Verify password hook\nexport const useVerifyPassword = () => {\n  return useMutation<VerifyPasswordResponse, unknown, VerifyPasswordPayload>({\n    mutationFn: async (payload: VerifyPasswordPayload) => {\n      const token = localStorage.getItem(\"adminToken\");\n      const { data } = await api.post(\"/admin/verify-password\", payload, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      return data;\n    },\n  });\n};\n","import axios from './lib/axios.js';\n\n// This module is intended to unwrap Axios default export as named.\n// Keep top-level export same with static properties\n// so that it can keep same with es module or cjs\nconst {\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n} = axios;\n\nexport {\n  axios as default,\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n}\n","\"use client\";\n\nimport AdminLayout from \"@/componets/admin/AdminLayout\";\nimport React, { useState } from \"react\";\nimport { useUpdatePassword, useVerifyPassword } from \"@/hooks/admin\";\nimport { AxiosError } from \"axios\";\n\nconst Page = () => {\n  const [currentPassword, setCurrentPassword] = useState(\"\");\n  const [verified, setVerified] = useState(false);\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n\n  const verifyPasswordMutation = useVerifyPassword();\n  const updatePasswordMutation = useUpdatePassword();\n\n const handleVerify = (e: React.FormEvent) => {\n  e.preventDefault();\n\n  verifyPasswordMutation.mutate(\n    { password: currentPassword },\n    {\n      onSuccess: (res) => {\n        if (res.success) {\n          setVerified(true);\n          alert(\"Current password verified ✅\");\n        } else {\n          alert(\"Current password is incorrect ❌\");\n        }\n      },\n      onError: (err: unknown) => {\n        if (err instanceof AxiosError) {\n          alert(err.response?.data?.message || \"Failed to verify password ❌\");\n        } else {\n          alert(\"Failed to verify password ❌\");\n        }\n      },\n    }\n  );\n};\n\n  const handleUpdate = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (newPassword !== confirmPassword) {\n      alert(\"New password and confirm password do not match!\");\n      return;\n    }\n\n    updatePasswordMutation.mutate(\n      { currentPassword, newPassword },\n      {\n        onSuccess: (res) => {\n          alert(res.message || \"Password updated successfully ✅\");\n          setCurrentPassword(\"\");\n          setNewPassword(\"\");\n          setConfirmPassword(\"\");\n          setVerified(false);\n        },\n        onError: (err: unknown) => {\n          const error = err as AxiosError<{ message: string }>;\n  alert(error.response?.data?.message || \"Faild To Update Password\");\n        },\n      }\n    );\n  };\n\n  const isLoading =\n    verifyPasswordMutation.status === \"pending\" ||\n    updatePasswordMutation.status === \"pending\";\n\n  return (\n    <AdminLayout>\n      <div className=\"mx-auto bg-white p-6 rounded-2xl shadow-md max-w-md\">\n        <h1 className=\"text-2xl font-bold mb-6\">Change Password</h1>\n\n        {!verified ? (\n          <form onSubmit={handleVerify} className=\"space-y-5\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Current Password\n              </label>\n              <input\n                type=\"password\"\n                value={currentPassword}\n                onChange={(e) => setCurrentPassword(e.target.value)}\n                placeholder=\"Enter current password\"\n                className=\"w-full px-4 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#7a0706] focus:border-[#7a0706] hover:border-[#7a0706] transition\"\n                required\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={isLoading}\n              className=\"w-full bg-[#7a0706] cursor-pointer text-white py-2 px-4 rounded-lg shadow-md hover:bg-[#261b7d] transition transform hover:scale-[1.02] disabled:opacity-50\"\n            >\n              {verifyPasswordMutation.status === \"pending\" ? \"Verifying...\" : \"Verify Password\"}\n            </button>\n          </form>\n        ) : (\n          <form onSubmit={handleUpdate} className=\"space-y-5\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                New Password\n              </label>\n              <input\n                type=\"password\"\n                value={newPassword}\n                onChange={(e) => setNewPassword(e.target.value)}\n                placeholder=\"Enter new password\"\n                className=\"w-full px-4 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#7a0706] focus:border-[#7a0706] hover:border-[#7a0706] transition\"\n                required\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                Confirm New Password\n              </label>\n              <input\n                type=\"password\"\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                placeholder=\"Re-enter new password\"\n                className=\"w-full px-4 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#7a0706] focus:border-[#7a0706] hover:border-[#7a0706] transition\"\n                required\n              />\n            </div>\n\n            <button\n              type=\"submit\"\n              disabled={isLoading}\n              className=\"w-full bg-[#7a0706] cursor-pointer text-white py-2 px-4 rounded-lg shadow-md hover:bg-[#261b7d] transition transform hover:scale-[1.02] disabled:opacity-50\"\n            >\n              {updatePasswordMutation.status === \"pending\" ? \"Updating...\" : \"Update Password\"}\n            </button>\n          </form>\n        )}\n      </div>\n    </AdminLayout>\n  );\n};\n\nexport default Page;\n"],"names":[],"mappings":"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","ignoreList":[1]}